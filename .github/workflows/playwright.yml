name: playwright test

on: 
  push:
    branches: [master]

jobs: 
  playwrightTest:
    runs-on: ubuntu-latest 
    container: 
     image: mcr.microsoft.com/playwright:v1.29.1-focal
     env:
       ADMIN_PASSWORD : ${{secrets.ADMIN_PASSWORD}}
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
      - name: Run tests 
       run : |
        echo "start the shopping store application"
        ./shopping-store-linux-amd64 &
        echo "install dependencies from lockfile"
        npm ci 
        echo "run playwright tests"
        npm run test:ci
